<%= form_for(@foaf) do |f| %>
  <% if @foaf.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@foaf.errors.count, "error") %> prohibited this foaf from being saved:</h2>

      <ul>
      <% @foaf.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div class="field">
    <%= f.label :name, 'Your name, e.g. "Bob Smith"'%>
    <%= f.text_field :name %>
  </div>
  
  <div class="field">
    <%= f.label :slug, 'Your slug, e.g. "bsmith"' %>
    <%= f.text_field :slug %>
  </div>

  <div class="field">
    <%= f.label :work, "URI for Your Place of Work" %>
    <%= f.text_field :work, value: "http://library.princeton.edu" %>
  </div>

  <div class="field">
    <%= f.label :birthday, "Your Birthday" %>
    <%= f.text_field :birthday, value: "yyyy-mm-dd", class: "datepicker" %>
  </div>

  <h3>Interests</h3>

<div class="field">
      <input name='foaf[interests_attributes]' type='hidden' id='e9' style='width:300px'/>
</div>

  <div class="actions">
    <%= f.submit "Create My FOAF!" %>
  </div>

  <script type="text/javascript">
    function movieFormatResult(result) {
        var markup = result.text;
        return markup;
    }

    function movieFormatSelection(result) {
        return result.text;
    }

    $(document).ready(function() {
      $('.datepicker').datepicker({
        format: 'yyyy-mm-dd'
      });


$("#e9").select2({

       placeholder: {title: "Search for a movie", id: "s"},
        minimumInputLength: 3,
        multiple: true,
        ajax: {
            url: "http://localhost:3000/fake.json",
            dataType: 'json',
            quietMillis: 100,
            data: function (term, page) { // page is the one-based page number tracked by Select2
                return {
                    /*
                    q: term, //search term
                    page_limit: 10, // page size
                    page: page, // page number
                    apikey: "ju6z9mjyajq2djue3gbvv26t" // please do not use so this example keeps working
                    */
                };
            },
            results: function (data, page) {
                var more = (page * 10) < data.total; // whether or not there are more results available

                // notice we return the value of more so Select2 knows if more results can be loaded
                return {results: data.results, more: more};
            }
        },
        formatResult: movieFormatResult, // omitted for brevity, see the source of this page
        formatSelection: movieFormatSelection // omitted for brevity, see the source of this page

        });

    });
  </script>

<% end %>
